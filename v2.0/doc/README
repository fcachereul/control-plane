1.  INTRODUCTION

    The Open control plane implements the functions of LISP (Locator/Identifier Separation Protocol) control plane.
    Please refer to IETF LISP drafts for a description of LISP control plane, its acronyms and 
    the control-plane functionalities.	
    
    The Open control plane is compatible and designed to work with the OpenLISP data-plane (http://www.openlisp.org), 
    and is therefore developed in a FreeBSD evnironment.

    The implemented two main function are map-server and map-resolve. Addtional function to support 
    LISP Delegated Database Tree (DDT) using in lisp testeb network (lisp4.net).

    Additional functionalities related to control-plane and how to deploy xTR with OpenLISP and OpenLISP control-plane 
    please refer to http://www.lisp.ipv6.lip6.fr (hosted beyond LISP!).

2. CONFIGURATION FILE

    Basic information needed by the lisp_mapping are contained in the main configure file and extern xml file: one for 
    xTR function, one for map-server function and the last one for map-resolve or ddt-node function

    ***Main configure file: define the functions will be serviced and the path to extern configure files for each functions.

    # Functions we want to be serving: xTR, ms(Map-server), mr(Map-resolve), ddt|node(DDT-node)
    # You can not use xTR with Map-server/Map-resolve function
    
    functions = ms mr ddt
    #functions = xTR

    #Enable ipv6 or not, default is yes
    #ipv6_support = yes

    #Chose source ip for map-respone package
    #Default is auto select

    source_ipv4 = auto
    source_ipv6 = auto

    ##
    ## xTR specific settings
    ##

    xtr_configure = opencp_xtr.xml
    ms_configure = opencp_ms.xml
    mr_configure = opencp_mr.xml

    *** Each extern xml configure file inclues many sections put between tags <db> and </db>.
    
    a. opencp_ms.xml - Configure file for map-server

    * One <geid> section, defined the ranges of ip which this map-server allowed ETR to register to. 
    Notice: the ranges must not be overlap each other.
    
    * One or more <site> sections. Each section includes the information for one site: name of site, key which site used when 
    send map-register message, ranges of ip which site can register. Notice: key is case sensitive and must not include space.

--------------------------
<?xml version="1.0" encoding="ISO-8859-1"?>
<db>
	 <geid>
		<arrange>153.16.38.0/24</arrange>
		<arrange>153.16.44.0/24</arrange>
		<arrange>153.16.70.0/24</arrange>
		<arrange>192.168.0.0/16</arrange>
		<arrange family="IPv6">2610:D0::/32</arrange>
	 </geid>
	 
	 <site>
		<name>lip6</name>
		<key>lip6-KEY-HERE</key>
		<contact>stefano.secci@lip6.fr</contact>
		<active>yes</active>

		<eid>
			<addr family="IPv4">153.16.38.0/24</addr>
			<active>yes</active>
		</eid>

		<eid>
			<addr family="IPv6">2610:d0:2121::/48</addr>
			<active>yes</active>
		</eid>
	</site>
	
	<site>
		<name>unirome</name>
		<key>uniroma-KEY-HERE</key>
		<contact>admin@uniroma.it</contact>
		<active>yes</active>

		<eid>
			<addr family="IPv4">153.16.44.112/28</addr>
			<active>yes</active>
		</eid>

		<eid>
			<addr family="IPv6">2610:d0:1129::/48</addr>
			<active>yes</active>
		</eid>
	</site>

	<site>
		<name>vnu</name>
		<key>vnu-KEY-HERE</key>
		<contact>dungpc@vnu.edu.vn</contact>
		<active>yes</active>

		<eid>
			<addr family="IPv4">153.16.70.16/28</addr>
			<active>yes</active>
		</eid>

		<eid>
			<addr family="IPv6">2610:d0:3215::/48</addr>
			<active>yes</active>
		</eid>
	</site>

</db>

    
    b. opencp_ms.xml - Configure file for map-ddnode and map-resolve

    * One <geid> section, defined the ranges of ip which this server can be delegate.
    Notice: the ranges must not be overlap each other.

    * One or more <eid> sections. Each section show information for one prefix delegation.

    * Special <eid> sections with prefix equal 0.0.0.0/0 or 0::/0 is used to defined root DDT root. 
    At this time, there are four DDT root in lisp tesbed network: http://ddt-root.org/

    For more information about prefix delegation and how DDT working, please refer to IETF draft.

--------------------------
<?xml version="1.0" encoding="ISO-8859-1"?>
<db>
	<geid>
		<arrange>153.17.0.0/16</arrange>
		<arrange>153.18.0.0/16</arrange>
		<arrange>192.0.0.0/8</arrange>
		<arrange family="IPv6">2610:d0::/32</arrange>
	 </geid>

	<eid prefix="153.17.0.0/16" ttl="1440" a="true" referral="true">
		<rloc>
			<address>112.137.129.44</address>
			<priority>1</priority>
			<weight>100</weight>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address>112.137.129.45</address>
			<priority>10</priority>
			<weight>100</weight>
			<reachable>true</reachable>
		</rloc>
	</eid>
	
	<eid prefix="192.100.0.0/16" ttl="1440" a="true" referral="true">
		<rloc>
			<address>112.137.129.44</address>
			<priority>10</priority>
			<weight>100</weight>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address>112.137.129.45</address>
			<priority>1</priority>
			<weight>100</weight>
			<reachable>true</reachable>
		</rloc>
	</eid>
	
	<eid prefix="0.0.0.0/0" referral="true" incomplete="false">
		<rloc>
			<address>192.149.252.136</address>
			<priority>1</priority>
			<weight>100</weight>
			<reachable>true</reachable>
		</rloc>
	</eid>
	
	<eid prefix="2610:d0::/16" referral="true" incomplete="false">
		<rloc>
			<address>2001:67c:2980::2980</address>
			<priority>1</priority>
			<weight>100</weight>
			<reachable>true</reachable>
		</rloc>
	</eid>
</db>
    c. opencp_xtr.xml - Configure file for xTR node

    * One <mapserver> section, defined the list of Map-server which this server must send
    map-register to, each map-server need a key to authen.

    * One <mapresolve> section, defined the list of Map-resolve which this server can request
    to get mapping.

    * One or more <eid> sections. Each section show information for one prefix delegation.

    For more information about xTR functions, please refer to IETF draft.

--------------------------
<?xml version="1.0" encoding="ISO-8859-1"?>
<db>
	<mapserver>
		<ms key="KEY-HERE">193.162.145.50</ms>
		<ms key="KEY-HERE">195.50.116.18</ms>
		<ms family="IPv6" key="KEY-HERE">2001:67c:21b4:109::b</ms>
	</mapserver>
	
	<mapresolve>
		<mr>193.162.145.50</mr>
		<mr family="IPv6">2001:67c:21b4:109::b</mr>
	</mapresolve>
	
	<eid prefix="153.16.38.0/24" ttl="60" act="0" a="0" version="1" active="true">
		<rloc>
			<address>132.227.62.243</address>
			<priority>2</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>false</local>
			<rloc-probing>false</rloc-probing>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address>132.227.62.242</address>
			<priority>4</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>true</local>
			<rloc-probing>true</rloc-probing>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address family="IPv6">2001:660:3302:282C:240::242</address>
			<priority>5</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>true</local>
			<rloc-probing>true</rloc-probing>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address family="IPv6">2001:660:3302:282C:240::243</address>
			<priority>6</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>false</local>
			<rloc-probing>false</rloc-probing>
			<reachable>true</reachable>
		</rloc>
	</eid>
	
	<eid family="IPv6" prefix="2610:D0:2121::/48" ttl="60" act="0" a="0" version="1"	active="true">
		<rloc>
			<address>132.227.62.243</address>
			<priority>1</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>false</local>
			<rloc-probing>false</rloc-probing>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address>132.227.62.242</address>
			<priority>2</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>true</local>
			<rloc-probing>true</rloc-probing>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address family="IPv6">2001:660:3302:282C:240::242</address>
			<priority>5</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>true</local>
			<rloc-probing>true</rloc-probing>
			<reachable>true</reachable>
		</rloc>
		<rloc>
			<address family="IPv6">2001:660:3302:282C:240::243</address>
			<priority>3</priority>
			<m_priority>0</m_priority>
			<weight>100</weight>
			<m_weight>0</m_weight>
			<local>false</local>
			<rloc-probing>false</rloc-probing>
			<reachable>true</reachable>
		</rloc>
	</eid>
</db>

3. DEBUG
    When running, the program prints debug information to the console so you can flow the processing. It also inclue
    another method to debug by interact with the program over command line in the console. At this version, supported 
    command include:
	
	map-database

	map-register <EID-prefix> version <version_number>  A <true|false> TTL <time_to_live> /
	  < -rloc address <rloc_addr>  priority <rloc_priority> weight <rloc_weight> m_weight <rloc_m_weight> /
	  m_priority <rloc_m_priority> reachable <true|false> ...>

	map-request <EID-prefix>  <nonce>
		   
4. INSTALL
    
    Please refer to the INSTALL file in tarball source code.


5. COMMENT AND BUG
    
    All comment and bug report are welcome!
